<!DOCTYPE html>
<html>
<head>
    <title>Weapons</title>
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 6px; }
        th { background: #eee; }
    </style>
</head>
<body>

<h2>Weapons</h2>

<input id="search" placeholder="Search weapons..." />

<table id="primaryWeaponsTable">
    <thead></thead>
    <tbody></tbody>
</table>

<script>
async function loadWeapons(query="") {
    const res = await fetch(`/api/primaryWeapons?q=${query}`);
    const data = await res.json();

    const thead = document.querySelector("thead");
    const tbody = document.querySelector("tbody");

    tbody.innerHTML = "";
    thead.innerHTML = "";

    if (data.length === 0) return;

    // Build header dynamically from DB columns
    const headers = Object.keys(data[0]);
    thead.innerHTML = "<tr>" + headers.map(h => `<th>${h}</th>`).join("") + "</tr>";

    data.forEach(row => {
        const tr = document.createElement("tr");
        headers.forEach(h => {
            tr.innerHTML += `<td>${row[h]}</td>`;
        });
        tbody.appendChild(tr);
    });
}

document.getElementById("search").addEventListener("input", e => {
    loadWeapons(e.target.value);
});

loadWeapons();
</script>

</body>
</html>
