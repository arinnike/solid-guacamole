{% extends "base.html" %}

{% block title %}Primary Weapons{% endblock %}

{% block content %}

<h2 class="text-2xl font-bold mb-4">Weapons</h2>

<!-- Local styles (temporary â€“ can move to styles.css later) -->
<style>
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 6px; }
  th { background: #eee; }
</style>

<input
  id="search"
  placeholder="Search weapons..."
  class="border p-2 mb-4 w-full rounded dark:bg-zinc-700"
/>

<table id="primaryWeaponsTable">
  <thead></thead>
  <tbody></tbody>
</table>

<script>
async function loadWeapons(query="") {
  const res = await fetch(`/api/primary_weapons?q=${query}`);
  const data = await res.json();

  const thead = document.querySelector("#primaryWeaponsTable thead");
  const tbody = document.querySelector("#primaryWeaponsTable tbody");

  tbody.innerHTML = "";
  thead.innerHTML = "";

  if (data.length === 0) return;

  const headers = Object.keys(data[0]);

  thead.innerHTML =
    "<tr>" + headers.map(h => `<th>${h}</th>`).join("") + "</tr>";

  data.forEach(row => {
    const tr = document.createElement("tr");
    headers.forEach(h => {
      tr.innerHTML += `<td>${row[h]}</td>`;
    });
    tbody.appendChild(tr);
  });
}

document.getElementById("search").addEventListener("input", e => {
  loadWeapons(e.target.value);
});

loadWeapons();
</script>

{% endblock %}